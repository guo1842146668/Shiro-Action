<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="im.zhaojun.system.mapper.EquipmentMapper">

    <resultMap type="im.zhaojun.system.model.Equipment" id="SysDictDataResult">
        <id     property="equipmentID"   column="equipmentID"   />
        <result property="userID"   column="userID"   />
        <result property="equipmentName"  column="equipmentName"  />
        <result property="equipmentNO"  column="equipmentNO"  />
        <result property="equipmentType"   column="equipmentType"   />
        <result property="equipmentAddress"   column="equipmentAddress"/>
        <result property="electricCurrentIA"  column="electricCurrentIA"  />
        <result property="electricCurrentIB"  column="electricCurrentIB"  />
        <result property="electricCurrentIC"     column="electricCurrentIC"/>
        <result property="electricStatus"   column="electricStatus"/>
        <result property="runningState"   column="runningState"/>
        <result property="OperationMode"   column="OperationMode"/>
        <result property="FaultStatus"   column="FaultStatus"/>
    </resultMap>

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        equipmentID,userID,equipmentName,equipmentNO,equipmentType,equipmentAddress,electricCurrentIA,
        electricCurrentIB,electricCurrentIC,electricStatus,runningState,OperationMode,FaultStatus
    </sql>

    <insert id="saveEquipment" keyColumn="user_id" keyProperty="userId" useGeneratedKeys="true">
        insert  into  equipment(userID,equipmentName,equipmentNO,equipmentType,equipmentAddress
        ,electricCurrentIA,electricCurrentIB,electricCurrentIC,electricStatus,runningState,OperationMode,FaultStatus)
        value (#{userID},#{equipmentName},#{equipmentNO},#{equipmentType},#{equipmentAddress},
        #{electricCurrentIA},#{electricCurrentIB},#{electricCurrentIC},#{electricStatus},#{runningState},#{OperationMode},#{FaultStatus})
    </insert>

    <update id="updateEquipment">
        update  equipment
        <set>
            <if test="userID != null">
                userID = #{userID},
            </if>
            <if test="equipmentName != null">
                equipmentName = #{equipmentName},
            </if>
            <if test="equipmentNO != null">
                equipmentNO = #{equipmentNO},
            </if>
            <if test="equipmentType != null">
                equipmentType = #{equipmentType},
            </if>
            <if test="equipmentAddress != null">
                equipmentAddress = #{equipmentAddress},
            </if>
            <if test="electricCurrentIA != null">
                electricCurrentIA = #{electricCurrentIA},
            </if>
            <if test="electricCurrentIB != null">
                electricCurrentIB = #{electricCurrentIB},
            </if>
            <if test="electricCurrentIC != null">
                electricCurrentIC = #{electricCurrentIC},
            </if>
            <if test="electricStatus != null">
                electricStatus = #{electricStatus},
            </if>
            <if test="runningState != null">
                runningState = #{runningState},
            </if>
            <if test="OperationMode != null">
                OperationMode = #{OperationMode},
            </if>
            <if test="FaultStatus != null">
                FaultStatus = #{FaultStatus},
            </if>
        </set>
        where equipmentID = #{equipmentID}
    </update>

    <update id="updateByEquipmentNo">
        update  equipment
        <set>
            <if test="userID != null">
                userID = #{userID},
            </if>
            <if test="equipmentName != null">
                equipmentName = #{equipmentName},
            </if>
            <if test="equipmentNO != null">
                equipmentNO = #{equipmentNO},
            </if>
            <if test="equipmentType != null">
                equipmentType = #{equipmentType},
            </if>
            <if test="equipmentAddress != null">
                equipmentAddress = #{equipmentAddress},
            </if>
            <if test="electricCurrentIA != null">
                electricCurrentIA = #{electricCurrentIA},
            </if>
            <if test="electricCurrentIB != null">
                electricCurrentIB = #{electricCurrentIB},
            </if>
            <if test="electricCurrentIC != null">
                electricCurrentIC = #{electricCurrentIC},
            </if>
            <if test="electricStatus != null">
                electricStatus = #{electricStatus},
            </if>
            <if test="runningState != null">
                runningState = #{runningState},
            </if>
            <if test="OperationMode != null">
                OperationMode = #{OperationMode},
            </if>
            <if test="FaultStatus != null">
                FaultStatus = #{FaultStatus},
            </if>
        </set>
        where  equipmentNO = #{equipmentNO}

    </update>

    <delete id="deleteEquipment">
        delete  from equipment where equipmentID = #{equipmentID}
    </delete>

    <select id="listAll" parameterType="im.zhaojun.system.model.Equipment" resultType="java.util.Map">
        select  <include refid="Base_Column_List"/>
        ,(SELECT username from user where user_id = equipment.userID) as username
        ,(SELECT dictName from dict where dictID = equipment.equipmentType) as equipmentTypeName
        from equipment
       <where>

                <if test="equipmentNO !=  null and equipmentNO != ''">
                    equipmentNO like "%"#{equipmentNO}"%"
                </if>
                <if test="equipmentName != null and equipmentName !=''" >
                  and   equipmentName like "%"#{equipmentName}"%"
                </if>
                <if test="equipmentAddress != null and equipmentAddress !=''">
                  and   equipmentAddress like "%"#{equipmentAddress}"%"
                </if>
                <if test="equipmentType != null and equipmentType !=''">
                  and   equipmentType like "%"#{equipmentType}"%"
                </if>
                <if test="userID != null and userID !=''">
                  and   userID like "%"#{userID}"%"
                </if>
               <if test="equipmentID != null and equipmentID !=''">
                   and   userID in (SELECT user_id from `user` where dept_id = #{equipmentID})
               </if>

        </where>
        order by electricStatus desc
    </select>

    <select id="selectOne" resultType="java.util.Map">
        select  <include refid="Base_Column_List"/>
        ,(SELECT username from user where user_id = equipment.userID) as username
        ,(SELECT dictName from dict where dictID = equipment.equipmentType) as equipmentTypeName
        from equipment WHERE equipmentID = #{equipmentID}
    </select>

    <select id="selectByEquipmentNO" resultType="java.util.Map">
        select <include refid="Base_Column_List"/> from equipment
        where equipmentNO = #{equipmentNO}
    </select>

    <select id="selectScheduled" resultType="java.util.Map">
        select  * from scheduled where equipmentNO = #{equipmentNO}
    </select>
</mapper>
